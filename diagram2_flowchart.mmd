flowchart TD
    Start([Game Start Trigger]) --> Init["Initialize Variables:<br/>sequence array, turn=1, gameOver=false"]
    Init --> GenSeq["Generate Random Number 1-4<br/>sequence[turn-1] = random()"]
    GenSeq --> ShowSeq["Display Sequence Loop:<br/>FOR i=0 to turn-1"]
    ShowSeq --> LED["Turn ON LED sequence[i]<br/>Play Sound sequence[i]<br/>Delay 500ms"]
    LED --> LEDOff["Turn OFF LED sequence[i]<br/>Delay 200ms"]
    LEDOff --> SeqCheck{"i < turn-1?"}
    SeqCheck -->|Yes| NextLED["i++"] --> LED
    SeqCheck -->|No| WaitInput["Wait for User Input<br/>inputIndex = 0"]
    
    WaitInput --> ReadBtn["Read Button Input"]
    ReadBtn --> BtnPressed{"Button Pressed?"}
    BtnPressed -->|No| Timeout{"Timeout 5000ms?"}
    Timeout -->|No| ReadBtn
    Timeout -->|Yes| GameOver["Game Over<br/>Calculate Score"]
    
    BtnPressed -->|Yes| ValidateInput{"userInput == sequence[inputIndex]?"}
    ValidateInput -->|No| GameOver
    ValidateInput -->|Yes| CorrectSound["Play Correct Sound<br/>inputIndex++"]
    CorrectSound --> AllCorrect{"inputIndex == turn?"}
    AllCorrect -->|No| ReadBtn
    AllCorrect -->|Yes| LevelUp["Level Complete<br/>turn++, level++"]
    LevelUp --> MaxLevel{"turn > 100?"}
    MaxLevel -->|Yes| GameOver
    MaxLevel -->|No| GenSeq
    
    GameOver --> CalcScore["Calculate Final Score:<br/>score = level * 10 + bonuses"]
    CalcScore --> SendScore["Send Score to Server<br/>POST /submit-score"]
    SendScore --> Reset["Reset for Next Game"]
    Reset --> End([End])
    
    style Start fill:#90EE90
    style GameOver fill:#FFB6C1
    style CalcScore fill:#87CEEB
    style End fill:#DDA0DD 